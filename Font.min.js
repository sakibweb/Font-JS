class Font{constructor(t,o){this.providerName=t?t.toLowerCase():this._detectProvider(o),this.fontConfig=o,this.providers={google:this._loadGoogleFont.bind(this),go:this._loadGoogleFont.bind(this),g:this._loadGoogleFont.bind(this),adobe:this._loadAdobeFont.bind(this),ad:this._loadAdobeFont.bind(this),a:this._loadAdobeFont.bind(this),typekit:this._loadAdobeFont.bind(this),type:this._loadAdobeFont.bind(this),kit:this._loadAdobeFont.bind(this),ty:this._loadAdobeFont.bind(this),tk:this._loadAdobeFont.bind(this),font_awesome:this._loadFontAwesome.bind(this),font:this._loadFontAwesome.bind(this),wesome:this._loadFontAwesome.bind(this),fo:this._loadFontAwesome.bind(this),we:this._loadFontAwesome.bind(this),fw:this._loadFontAwesome.bind(this),bunny:this._loadBunnyFont.bind(this),bun:this._loadBunnyFont.bind(this),bu:this._loadBunnyFont.bind(this),fontshare:this._loadFontshareFont.bind(this),sh:this._loadFontshareFont.bind(this),fs:this._loadFontshareFont.bind(this),local:this._loadLocalFont.bind(this),lo:this._loadLocalFont.bind(this),custom:this._loadCustomFont.bind(this),selfhosted:this._loadCustomFont.bind(this)}}_detectProvider(t){return t.projectId||t.kitId?"adobe":t.family||t.name&&"google"===t.provider?"google":"fontawesome"===t.cdn||t.iconSet?"font_awesome":"bunny"===t.provider||t.bunnyFontFamily?"bunny":"fontshare"===t.provider||t.fontshareId?"fontshare":t.localFontName||t.localSrc?"local":(t.url||t.css||t.name&&t.src,"custom")}load(){return new Promise(((t,o)=>{const e=this.providers[this.providerName];e?e(this.fontConfig,t,o):o(`Provider "${this.providerName}" is not supported or could not be detected.`)}))}_loadGoogleFont(t,o,e){if(!t.name&&!t.family)return void e("Font name or family is required for Google Fonts.");const s=(t.name||t.family).replace(/\s+/g,"+");let n=t.weight||t.weights||"400",i=(t.style||t.styles,t.subset||t.subsets),a=t.display||"swap",l=`https://fonts.googleapis.com/css2?family=${s}`;n&&("string"==typeof n||"number"==typeof n?l+=`:wght@${n}`:Array.isArray(n)&&(l+=`:wght@${n.join(";")}`)),i&&("string"==typeof i?l+=`&subset=${i}`:Array.isArray(i)&&(l+=`&subset=${i.join(",")}`)),l+=`&display=${a}`,this._loadCSS(l,t,o,e,s.replace(/\+/g," "))}_loadAdobeFont(t,o,e){let s=t.projectId||t.kitId;if(!s)return void e("Adobe Fonts Project ID or Kit ID is required for Adobe Fonts.");const n=`https://use.typekit.net/${s}.css`;this._loadCSS(n,t,o,e)}_loadFontAwesome(t,o,e){let s="";s=t.url?t.url:t.version?`https://cdnjs.cloudflare.com/ajax/libs/font-awesome/${t.version}/css/all.min.css`:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css",this._loadCSS(s,t,o,e)}_loadBunnyFont(t,o,e){if(!t.family&&!t.bunnyFontFamily)return void e("Font family (bunnyFontFamily or family) is required for Bunny Fonts.");const s=t.family||t.bunnyFontFamily,n=t.variants||t.weights||t.variant,i=t.subsets||t.subset;let a=`https://fonts.bunny.net/${t.format||"css2"}?family=${s.replace(/\s+/g,"+")}`;n&&("string"==typeof n?a+=`&variant=${n}`:Array.isArray(n)&&(a+=`&variant=${n.join(",")}`)),i&&("string"==typeof i?a+=`&subset=${i}`:Array.isArray(i)&&(a+=`&subset=${i.join(",")}`)),this._loadCSS(a,t,o,e,s)}_loadFontshareFont(t,o,e){if(!t.id&&!t.fontshareId)return void e("Font ID (fontshareId or id) is required for Fontshare.");const s=`https://fontshare.com/api/css?f=${t.id||t.fontshareId}`;this._loadCSS(s,t,o,e)}_loadLocalFont(t,o,e){if(!t.localFontName&&!t.name)return void e("Font name (localFontName or name) is required for local fonts.");if(!t.localSrc&&!t.src)return void e("Font source (localSrc or src) is required for local fonts.");const s=t.localFontName||t.name,n=t.localSrc||t.src,i=this._generateFontFaceRule({name:s,src:n,weight:t.weight,style:t.style,...t});this._createAndInjectCSS(i,t,o,e,s)}_loadCustomFont(t,o,e){if(t.url)this._loadCSS(t.url,t,o,e);else if(t.css)this._createAndInjectCSS(t.css,t,o,e);else if(t.name&&t.src){const s=this._generateFontFaceRule(t);this._createAndInjectCSS(s,t,o,e,t.name)}else e("For 'custom' or 'selfhosted' provider, you must provide 'url', 'css', or both 'name' and 'src' in fontConfig.")}_loadCSS(t,o,e,s,n){const i=document.createElement("link");i.rel="stylesheet",i.href=t,i.onload=()=>{o.use&&this._applyFontClass(o.use,n||o.name,o),e()},i.onerror=()=>{s(`Failed to load CSS from URL: ${t}`)},document.head.appendChild(i)}_createAndInjectCSS(t,o,e,s,n){const i=document.createElement("style");i.textContent=t,document.head.appendChild(i),o.use&&this._applyFontClass(o.use,n||o.name,o),e()}_generateFontFaceRule(t){let o="@font-face {\n";o+=`  font-family: '${t.name}';\n`,o+=`  src: url('${t.src}')`;let e="woff2";return t.src.endsWith(".woff")&&(e="woff"),t.src.endsWith(".ttf")&&(e="truetype"),t.src.endsWith(".otf")&&(e="opentype"),t.src.endsWith(".svg")&&(e="svg"),t.src.endsWith(".eot")&&(e="embedded-opentype"),o+=` format('${e}');\n`,(t.weight||t.fontWeight)&&(o+=`  font-weight: ${t.weight||t.fontWeight};\n`),(t.style||t.fontStyle)&&(o+=`  font-style: ${t.style||t.fontStyle};\n`),t.display?o+=`  font-display: ${t.display};\n`:o+="  font-display: swap;\n",o+="}\n",o}_applyFontClass(t,o,e){if(t&&o){let s=document.getElementById(`font-style-${t.replace(/[^a-zA-Z0-9]/g,"-")}`);s||(s=document.createElement("style"),s.id=`font-style-${t.replace(/[^a-zA-Z0-9]/g,"-")}`,document.head.appendChild(s));let n=`\n${t} {\n  font-family: "${o}", sans-serif;\n`;(e.weight||e.fontWeight)&&(n+=`  font-weight: ${e.weight||e.fontWeight};\n`),(e.style||e.fontStyle)&&(n+=`  font-style: ${e.style||e.fontStyle};\n`),e.fontDisplay&&(n+=`  font-display: ${e.fontDisplay};\n`),n+="}\n",s.textContent=n}else t&&document.documentElement.classList.add(t.substring(1))}}
